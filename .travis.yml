language: php

services:
  - docker

php:
  - '7.2'

git:
  depth: 1

before_install:
  - composer install
  - vendor/unb-libraries/dockworker/scripts/travis/init.sh

script:
  - set -e
  - vendor/bin/dockworker local:build-test
  - vendor/unb-libraries/dockworker/scripts/kubectl/init.sh
  - vendor/bin/dockworker image:deploy $TRAVIS_BRANCH

notifications:
  slack:
    rooms:
      secure: qyqmzwuSMuXfopYb+v5HfHK3PgNozJtUkdLePbpiH/ZENil+V6AUtDB+5TndhBP/ucRIso2/uFiJKwDcXZXntdjKH46R6RLvJZlqIwYqYQ+QutB4/qXKcPQGe7+a5q7oS9zd9PFs4O37iz/8tfp9MHIhkNuqfB3srIrz0g8Vg03g35q2Idfh5z2GPhAMpBGjP3wWbGG4iBdvCidxoTLWYPozW3m8jR3dLLG3NWtgJrQ8xiiMacSWBwHrPV9jr6oEYc9/nvUdEI5PXCnHHIO+gl6jdj7OBq+WNpVofmsKl3WKBEJt1GwFbK2TFPWTfew7k2K5zboBQriYFiKPtwlicxG+6VNGKMJdQ/OnBUwZB5EB1ZELZDBN6hoFDMf1Qa17+ekAL7lpZYlJ4R1bHkQzVIp2Fu92LtgMp6V7okFZ1E01K8jbdr6pR+yL4EQPjXH7AOqD8dozOYvK1XrPpRWaagbkCbqE/oOHYOb6LyhcxYoKY+cTXIDz2eGxGgB8oU43hHrPk9Kwfx/ISejDgVnkjFYAFM7uer+qbVVGcW/iTsjbjvURtf+e/gnb2ud5JrwZXUU6jVWvS5i+K6jlDGDN3OE/R7vTdLAUNgxXkDu34OaS120SRPVOJxYwHX9rQvspEj2MCc1Yt4fgJzwyiRtbpnQ4744ogrj14BTg5Z02w+s=
    on_start: always
    on_success: always
